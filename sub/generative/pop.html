<!DOCTYPE html>
<!-- saved from url=(0075)https://tomokuni-web-site.herokuapp.com/sub/generative/basic_particles.html -->
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta http-equiv="x-dns-prefetch-control" content="on">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Cache-Control" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <meta name="robots" content="noarchive">
  <meta name="author" lang="ja" content="Tomokuni Kani">
  <meta name="copyright" lang="ja" content="Tomokuni Kani">
  <meta name="description" lang="ja" content="Genarative Art">
  <style type="text/css">body{background-color:#FF8888;margin:0;padding:0;}#stage{position:fixed;margin:0;padding:0;top:0;}#bgm{display:none;}</style>
  <title>POP</title>
</head>
<body>
<canvas id="stage" width="1024" height="768"></canvas>
<iframe id="bgm" width="560" height="315" src="https://www.youtube.com/embed/ZCw2npjArVk?start=0&loop=1&autoplay=1" frameborder="0" allowfullscreen></iframe>
<script type="application/javascript" src="https://code.jquery.com/jquery-3.1.0.min.js"></script>
<script type="application/javascript" src="https://code.createjs.com/easeljs-0.8.2.min.js"></script>
<script type="application/javascript">
<!--

var stage, circle, line, text_message, background, nodeNumber=100, nodeArray = [], starNodeArray = [], linkArray = [], mouseX = innerWidth / 2, mouseY = innerHeight / 2, prevX=0, prevY=0, count=0;

function setup(){
  stage = new createjs.Stage("stage");
  stage.autoClear = false;
  stage.compositeOperation = "normal";
  for(var i=0; i<nodeNumber; ++i){
    var vNorm = Math.random(),
    f  = (255*vNorm / 60.0) - Math.floor(255*vNorm / 60.0),
    p  = Math.round(255 * (1.0 - (255 / 255.0))),
    q  = Math.round(255 * (1.0 - (255 / 255.0) * f)),
    t  = Math.round(255 * (1.0 - (255 / 255.0) * (1.0 - f))),
    red, green, blue;
    switch(Math.floor(255*vNorm / 60.0) % 6){
      case 0:
        red = 255, green = t, blue = p;
        break;
      case 1:
        red = q, green = 255, blue = p;
        break;
      case 2:
        red = p, green = 255, blue = t;
        break;
      case 3:
        red = p, green = q, blue = 255;
        break;
      case 4:
        red = t, green = p, blue = 255;
        break;
      case 5:
        red = 255, green = p, blue = q;
        break;
      default:
        break;
    }
    var n = new Node();
    n.setup(innerWidth * Math.random(), innerHeight * Math.random(), 0, 0, 0, 0, "rgba("+red+","+green+","+blue+",1)");
    nodeArray.push(n);
    var n = new StarNode();
    n.setup(innerWidth * Math.random(), innerHeight * Math.random(), 0, 0, 0, 0, "rgba("+red+","+green+","+blue+",1)");
    starNodeArray.push(n);
  }
  text_message = new createjs.Text("POP", "64px Arial", "#FF8888");
  text_message.alpha = 0.1;
  text_message.textBaseline = "alphabetic";
  text_message.x = (innerWidth - text_message.getBounds().width) / 2;
  text_message.y = (innerHeight - text_message.getBounds().height) / 2;
  stage.addChild(text_message);
  background = new createjs.Shape();
  background.alpha = 0.03;
  img = new Image();
  img.src = "img/pop_bg.jpg";
  matrix2d = new createjs.Matrix2D(1,0,0,1,0,0);
  img.onload = function() {
    if(innerWidth/innerHeight>=img.width/img.height){
      matrix2d.a = matrix2d.d = innerWidth/img.width;
    }else{
      matrix2d.a = matrix2d.d = innerHeight/img.height;
    }
	  background.graphics.beginBitmapFill(img, "no-repeat", matrix2d).drawRect(0, 0, innerWidth, innerHeight).endFill();
  };
	stage.addChild(background);
  handleResize();
  createjs.Ticker.timingMode = createjs.Ticker.RAF;
  createjs.Ticker.addEventListener("tick", stage);
  createjs.Ticker.addEventListener("tick", handleTick);
  window.onresize = handleResize;
  window.onmousemove = function (){
    mouseX = stage.mouseX, mouseY = stage.mouseY;
  };
  // document.onwheel = function (e) {
  //   brushThickness += 0.00000000001*e.deltaY;
  // };
}
function handleTick(){
  nodeArray.forEach(updateForEach);
  starNodeArray.forEach(updateForEach);
}
function handleResize() {
  stage.canvas.width = innerWidth;
  stage.canvas.height = innerHeight;
  text_message.x = (innerWidth - text_message.getBounds().width) / 2;
  text_message.y = (innerHeight - text_message.getBounds().height) / 2;
  background.graphics.clear();
  if(innerWidth/innerHeight>=img.width/img.height){
    matrix2d.a = matrix2d.d = innerWidth/img.width;
  }else{
    matrix2d.a = matrix2d.d = innerHeight/img.height;
  }
  background.graphics.beginBitmapFill(img, "no-repeat", matrix2d).drawRect(0, 0, innerWidth, innerHeight).endFill();
}
function updateForEach(element, index, array) {
  element.update();
}

var Node = (function () {
  function Node() {
    this.circle = new createjs.Shape();
    stage.addChild(this.circle);
  }
  Node.prototype.setup = function (x, y, vx, vy, ax, ay, color) {
    this.circle.graphics.beginFill(color).drawCircle(0, 0, 10);
    this.circle.x = x;
    this.circle.y = y;
    this.vx = vx;
    this.vy = vy;
    this.ax = ax;
    this.ay = ay;
    stage.setChildIndex (this.circle,nodeNumber-1);
  };
  Node.prototype.update = function () {
    var rangeX = mouseX - this.circle.x, rangeY = mouseY - this.circle.y, range = Math.sqrt(rangeX*rangeX+rangeY*rangeY),
    rangeCX = 0.5 * innerWidth - this.circle.x, rangeCY = 0.5 * innerHeight - this.circle.y, rangeC = Math.sqrt(rangeCX*rangeCX+rangeCY*rangeCY);
    this.ax = 0.0000001 * rangeCX / rangeC*rangeC*rangeC + 0.0000001 * rangeX / range*range*range;
    this.ay = 0.0000001 * rangeCY / rangeC*rangeC*rangeC + 0.0000001 * rangeY / range*range*range;
    this.vx += this.ax;
    this.vy += this.ay;
    this.circle.x += this.vx + Math.sin(this.vy) + Math.cos(0.01*rangeY);
    this.circle.y += this.vy + Math.cos(this.vx) + Math.sin(0.01*rangeX);
    this.circle.scaleX = this.circle.scaleY = 100*Math.sqrt(this.ax*this.ax+this.ay*this.ay);
  };
  return Node;
})();

var StarNode = (function () {
  function StarNode() {
    this.circle = new createjs.Shape();
    stage.addChild(this.circle);
  }
  StarNode.prototype.setup = function (x, y, vx, vy, ax, ay, color) {
    this.circle.graphics.beginFill(color).drawPolyStar(0,0,10,10,10,Math.PI/6);
    this.circle.x = x;
    this.circle.y = y;
    this.vx = vx;
    this.vy = vy;
    this.ax = ax;
    this.ay = ay;
    stage.setChildIndex (this.circle,nodeNumber-1);
  };
  StarNode.prototype.update = function () {
    var rangeX = mouseX - this.circle.x, rangeY = mouseY - this.circle.y, range = Math.sqrt(rangeX*rangeX+rangeY*rangeY),
    rangeCX = 0.5 * innerWidth - this.circle.x, rangeCY = 0.5 * innerHeight - this.circle.y, rangeC = Math.sqrt(rangeCX*rangeCX+rangeCY*rangeCY);
    this.ax = 0.0000001 * rangeCX / rangeC*rangeC*rangeC + 0.0000001 * rangeX / range*range*range;
    this.ay = 0.0000001 * rangeCY / rangeC*rangeC*rangeC + 0.0000001 * rangeY / range*range*range;
    this.vx += this.ax;
    this.vy += this.ay;
    this.circle.x += this.vx + 5 * (Math.random() - 0.5);
    this.circle.y += this.vy + 5 * (Math.random() - 0.5);
    this.circle.scaleX = this.circle.scaleY = 5*Math.sqrt(this.ax*this.ax+this.ay*this.ay);
  };
  return StarNode;
})();

window.onload = setup;

-->
</script>
</body>
</html>
